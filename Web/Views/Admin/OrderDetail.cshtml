@model Order
@{
    Layout = "_Admin";
    ViewData["Title"] = "Sipariş Detayı";
}

<h4>Sipariş Detayı #@Model.OrderId</h4>
<table>
    <thead>
        <tr>
            <th colspan="2">Ürün</th>
            <th>Adet</th>
            <th>Birim Fiyat</th>
            <th>Ara Toplam</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var cart in Model.Cart)
        {
            <tr>
                <td width="60">
                    <img src="~/tema/images/upload/@cart.Product.FeaturedImage" width="50" />
                </td>
                <td align="left">
                    @cart.Product.Title
                </td>
                <td>@cart.Piece</td>
                <td>@cart.Price.ToString("C")</td>
                <td>@cart.TotalPrice.ToString("C")</td>
            </tr>
        }
    </tbody>
</table>
<div class="row">
    <div class="orderDetail">
        <div class="col s12 l6 m6">
            <div class="orderBox">
                <h5>Sipariş Bilgileri</h5>
                <ul>
                    <li>Sipariş Kodu: @Model.OrderId</li>
                    <li>Sipariş Tarihi: @Model.OrderDate.ToShortDateString()</li>
                    <li>Toplam: @Model.TotalPrice.ToString("C")</li>
                    <li>Kargo Yöntemi: @Model.Cargo.Title</li>
                    <li>Ödeme Yöntemi: @Model.Payment.Name</li>
                    <li>3D Hata (Varsa): @Model.ThreeDError</li>
                    @if (Model.GiftBox)
                    {
                        <li>
                            Hediye Paketi Satır 1: @Model.GiftTextOne<br />
                            Hediye Paketi Satır 2: @Model.GiftTextTwo
                        </li>
                    }

                </ul>
            </div>
        </div>
        <div class="col s12 l6 m6">
            <div class="orderBox">
                <h5>Adres Bilgileri</h5>
                <ul>
                    <li>
                        Adı Soyadı: @Model.Name  @Model.Surname
                    </li>
                    <li>
                        Email: @Model.Email
                    </li>
                    <li>
                        GSM: @Model.GSM
                    </li>
                    <li>
                        Adres: @Model.Adress @Model.District.Title / @Model.City.Title
                    </li>
                </ul>
            </div>
        </div>
        <div class="col s12 l12 m12">
            <input type="text" name="CargoCode" placeholder="Kargo Kodu..." value="@Model.CargoCode" />
            <input type="button" name="SaveCargoCode" value="Kargo Takip Kayıt" />
        </div>
    </div>
</div>
@section Scripts{

    <script>

        $("[name='SaveCargoCode']").click(function () {

            var formData = new FormData();

            formData.append("CargoCode", $("[name='CargoCode']").val());

            fetch("/Admin/SaveCargoCode/@Model.OrderId", {
                method: "post",
                body: formData
            })
                .then(r => r.text())
                .then(r => { 
                
                    if (r == "1") { 
                    
                        alert("Kargo kodu kayıt edildi.");
                    
                    }
                
                })
        
        })

    </script>

}